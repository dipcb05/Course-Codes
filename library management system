#include<stdio.h>
#include<string.h>
#include<conio.h>
#include<windows.h>
#include<time.h>

int j,k,d;
FILE *fp;
char categories[][20]={"cse", "eee", "bba","bbainais", "eco"};
struct books
{
    int id;
    char name[20];
    char Author[20];
    int quantity;
    float Price;
    char *cat;
};
struct books book;

void password();
void mainmenu();
void addbooks();
void searchbooks();
void deletebooks();
void issuebooks();
void viewbooks();
void ebrecords();
void closeapp();
int getdata();
int checkid();
int intcmp(int a, int b)
{
    if(a>b)
    return 1;
else return 0;
}
void delay(unsigned int mseconds)
{
    clock_t goal = mseconds + clock();
    while (goal > clock());
}
COORD coord={0,0};
void gotoxy(int x, int y)
{
    coord.X=x;
    coord.Y=y;
    SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), coord);
}
void password()
{
    char pw[25]="Welcome to this system";
    char a[10];
    char b[10];
    system("cls");
    gotoxy(10,5);
    for(j=0;j<15;j++)
    {
    delay(50);
    printf("*");
    }
    printf(" ");
    for(j=0;j<22;j++)
    {
    delay(50);
    printf("%c",pw[j]);
    }
    printf(" ");
    for(j=0;j<15;j++)
    {
    delay(50);
    printf("*");
    }
    gotoxy(10, 8);
    printf("Make Your Password: ");
    gets(a);
    delay(50);
    gotoxy(10, 10);
    printf("Give Your Password: ");
    gets(b);
    if(strcmp(a,b)==0)
    {
        gotoxy(10,13);
        printf("\nPassword Matched!");
        gotoxy(10,15);
        printf("\nAny Key To Continue........");
        getchar();
        mainmenu();
    }
    else
    {
       gotoxy(10,13);
       printf("\aSorry! Password Do Not Matched....\n");
       gotoxy(10,15);
       printf("Please Try Again...\n");
       if(getchar())
       password();
    }
}
void mainmenu()
{
    int c;
    system("cls");
    gotoxy(10,2);
    for(j=0;j<10;j++)
    {
        printf("*");
    }
    printf("happy world of books");
    for(j=0;j<10;j++)
    {
        printf("*");
    }
    printf("\n");
    gotoxy(15,4);
    printf("1. Add books");
    gotoxy(15,6);
    printf("2. search books");
    gotoxy(15,8);
    printf("3. delete books");
    gotoxy(15,10);
    printf("4. issue books");
    gotoxy(15,12);
    printf("5. view book list");
    gotoxy(15,14);
    printf("6. edit book records");
    gotoxy(15,16);
    printf("7. close application");
    gotoxy(15,19);
    printf("Give Your Choice: ");
    scanf("%d", &c);

   switch(c)
  {
case 1: addbooks();
          break;

case 2: searchbooks();
          break;

case 3: deletebooks();
          break;

case 4: issuebooks();
          break;

case 5: viewbooks();
          break;

case 6: ebrecords();
          break;

case 7: closeapp();
          break;

default : {
            printf("\aA Wrong Try. Try again.....");
            getch();
            mainmenu();
          }

  }
}
void addbooks()
{
   system("cls");
   gotoxy(10,2);
   delay(60);
   printf("******     Select Categories     ******\n");
   gotoxy(10,5);
   delay(60);
   printf("1. Computer Engineering");
   gotoxy(10,7);
   delay(60);
   printf("2. Electrical Engineering");
   gotoxy(10,9);
   delay(60);
   printf("3. BBA");
   gotoxy(10,11);
   delay(60);
   printf("4. BBA in AIS");
   gotoxy(10,13);
   delay(60);
   printf("5. Economics");
   gotoxy(10,15);
   delay(60);
   printf("6. back to main menu\n");
   gotoxy(10,18);
   delay(60);
   printf("give your choice: ");
   scanf("%d", &d);
   if(d==6)
   {
       mainmenu();
   }
   else if (getdata()==1)
   {
   book.cat=categories[d-1];
   fp=fopen("addbooks.txt","ab+");
   fwrite(&book,sizeof(book),1,fp);
    fclose(fp);
    gotoxy(10,20);
    printf("Saved");
    gotoxy(10,22);
    printf("press enter to save more\n or press any key to back in main menu");
    if(getch()==13)
    addbooks();
    else
    mainmenu();
    }
}
void searchbooks()
{
   char e[50];
   char sb[50];
   system("cls");
   gotoxy(10,2);
   delay(60);
   printf("*****  searching option here  *****");
   gotoxy(18,5);
   delay(60);
   printf("Search System By ID");
   gotoxy(10,9);
   delay(60);
   printf("Press Enter to Return Main Menu\n\n\tOr Press Any Other Key To Continue. . . . .");
   if(getch()==13)
    mainmenu();
   else system("cls");
   gotoxy(10,5);
   printf("Give your desired book ID: ");
   scanf("%s", &e);
   gotoxy(10,8);
   printf("Loading");
   for(j=0;j<=20;j++)
   {
    delay(60);
    printf(". ");
   }
   system("cls");
   fp=fopen("addbooks.txt","rb");
    fscanf(fp,"%s",sb);
    if(strcmp(sb,e)==0)
        {
        printf("the book is avialable");
        delay(2000);
        printf("book name: %s", book.name);
        printf("author: %s", book.Author);
        }
   else printf("no record");
}
void deletebooks()
{

}
void issuebooks()
{

}
void viewbooks()
{

}
void ebrecords()
{

}
void closeapp()
{
      system("cls");
      gotoxy(15,8);
      printf("Thanks For Using This Application.");
      gotoxy(15,15);
      printf("Loading");
      for(j=0;j<=20;j++)
     {
        delay(60);
        printf(". ");
      }
      system("cls");
      gotoxy(15,10);
      printf("press any key to continue.\n");
      getch();
}
int getdata()
{
    int m;
    system("cls");
    gotoxy(10,8);
    printf("give info");
    gotoxy(10,10);
    printf("%s", categories[d-1]);
    gotoxy(10,12);
    printf("Book ID: ");
    scanf("%d",&m);
    if(checkid(m)==0)
    {
        gotoxy(10,12);
        printf("\aid is not valid, try again\a");
        getch();
        addbooks();
    }
    book.id=m;
    gotoxy(10,12);
    printf("Book Name: ");
    scanf("%s", &book.name);
    gotoxy(10,14);
    printf("Author: ");
    scanf("%s", &book.Author);
    gotoxy(10,16);
    printf("Quantity: ");
    scanf("%d", &book.quantity);
    gotoxy(10,18);
    printf("Price: ");
    scanf("%f", &book.Price);
    return 1;
}
int checkid(int z)
{
    while(fread(&book,sizeof(book),1,fp)==1)
    if(book.id==z)
    return 0;
    return 1;
}
int main()
{
    password();

    return 0;
}
